<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');//this controllar is proceed all the view and paginationclass Home extends MY_Controller {	public function __construct()	{		parent::__construct();		$this->permission->is_logged_in();		//load model		$this->load->helper('url');		$this->load->model('home_model');		$this->load->model('user_model');		$date = date('Y-m-d h:i:s');	}	function index()	{		$data = array();		$data['page'] = 'home_list';		if($query = $this->home_model->sort_date()->get_all())		{			$data['data_records'] = $query;		}		$data['main'] = 'home/home';		$data['js_function'] = array('home','hide_img');		$this->load->view('template/template',$data);	}	function error()	{		$data['page'] = 'error';		$this->load->view('home/error.php',$data);	}	function add_news()	{		$data = array();		$data['page'] = 'add_news';		$data['main'] = 'home/add_news';		$data['js_function'] = array('home');		$this->load->view('template/template',$data);	}	function add_news_data()	{		$this->load->library('form_validation');		$this->form_validation->set_rules('title', 'Title', 'required|trim|is_unique[tb_news.news_title]|alpha_dash');		$this->form_validation->set_rules('content', 'Content', 'required|trim');		$this->form_validation->set_rules('start_date', 'News Date', 'required|trim');		if($this->input->post('image')){			$this->form_validation->set_rules('image', 'Image', 'required|trim');		}		$this->form_validation->set_message('is_unique', 'The %s already exist.');		if ($this->form_validation->run() == FALSE)		{			$data = array();			$data['page'] = 'add_news';			$data['main'] = 'home/add_news';			$data['js_function'] = array('home');			$this->load->view('template/template',$data);		}		else		{			$title = $this->input->post('title');			$content = $this->input->post('content');			$image = $this->input->post('image');			$old_date = $this->input->post('start_date');			$old_date_timestamp = strtotime($old_date);			$news_date = date('Y-m-d', $old_date_timestamp);			$news_slug = url_title($title, '_', TRUE);			$datetime = date('Y-m-d h:i:s');			$data = array (					'news_id'=>'',					'news_title'=>$title,					'news_content'=>$content,					'news_date'=>$news_date,					'news_last_update'=>$datetime,					'news_slug'=>$news_slug			);			if ($this->home_model->insert($data))			{				$this->session->set_flashdata('success', 'The News have been successfully added');				redirect('home/add_news');			}			else			{				$this->session->set_flashdata('error', 'Error. Please try again.');				redirect('home/add_news');			}		}	}		## Delete apps ##	function ajax_delete_news()	{			//$this->permission->superadmin_admin_only();		$id = $this->input->post('news_id');		if($this->home_model->delete($id))		{			$msg = "success";			echo json_encode($msg);		}		else		{			$msg = "error";			echo json_encode($msg);		}	}	function login()	{		//$this->is_logged_in();		$this->load->view('login/login.php');	}	## checkbox for apps list under view ##	function checkbox_news_delete()	{		//$this->permission->superadmin_admin_only();		$data = array();		$id = $this->input->post('news_id');		foreach($id as $value){			if($query = $this->home_model->delete($value))			{				$data['data_records'] = $query;			}		}		$data['page'] = 'checkbox_tab_delete';		redirect('home/index', $data);	}	function edit_news()	{		//$this->permission->superadmin_admin_only();		$news_id = $this->uri->segment(3);		$data = array();		if($query = $this->home_model->get_by('news_id',$news_id))		{			$data['data_records'] = $query;		}		$data['js_function'] = array('home');		$data['page'] = 'edit_news';		$data['main'] = 'home/edit_news';		$this->load->view('template/template', $data);	}	## edit apps ##	function edit_news_data()	{		$this->load->library('form_validation');		$this->form_validation->set_rules('title', 'Title', 'required|trim');		$this->form_validation->set_rules('content', 'Content', 'required|trim');		$this->form_validation->set_rules('start_date', 'News Date', 'required|trim');		if($this->input->post('image')){			$this->form_validation->set_rules('image', 'Image', 'required|trim');		}		$this->form_validation->set_message('is_unique', 'The %s already exist.');		$news_id = $this->input->post('news_id');			if ($this->form_validation->run() == FALSE)			{				$data = array();				if($query = $this->home_model->get_by('news_id',$news_id))				{					$data['data_records'] = $query;				}				$data['js_function'] = array('home');				$data['page'] = 'edit_news';				$data['main'] = 'home/edit_news';				$this->load->view('template/template', $data);			}			else			{				$title = $this->input->post('title');				$content = $this->input->post('content');				//$image = $this->input->post('image');				$old_date = $this->input->post('start_date');				$old_date_timestamp = strtotime($old_date);				$news_date = date('Y-m-d', $old_date_timestamp);				$news_slug = url_title($title, '_', TRUE);				$datetime = date('Y-m-d h:i:s');				$data = array (					'news_title'=>$title,					'news_content'=>$content,					'news_date'=>$news_date,					'news_last_update'=>$datetime,					'news_slug'=>$news_slug				);				if ($this->home_model->update($news_id,$data))				{					$this->session->set_flashdata('success', 'Your News have been successfully updated');					redirect("home/edit_news/$news_id");				}				else				{					$this->session->set_flashdata('error', 'Error. Please try again.');					redirect("home/edit_news/$news_id");				}			}	}	function ajax_read_contact_file()	{		$contact_filename = $this->input->post('contact_filename');		$contact_file_path = './uploads/'.$contact_filename;		echo json_encode($contact_file_path);	}	}//end of class?>